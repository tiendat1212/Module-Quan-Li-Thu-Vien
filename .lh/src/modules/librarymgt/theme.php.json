{
    "sourceFile": "src/modules/librarymgt/theme.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 5,
            "patches": [
                {
                    "date": 1770046735813,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1770119649400,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,66 +1,88 @@\n-<?php\r\n-\r\n-/**\r\n- * NukeViet Content Management System\r\n- * @version 5.x\r\n- * @author VINADES.,JSC <contact@vinades.vn>\r\n- * @copyright (C) 2009-2025 VINADES.,JSC. All rights reserved\r\n- * @license GNU/GPL version 2 or any later version\r\n- * @see https://github.com/nukeviet The NukeViet CMS GitHub project\r\n- */\r\n-\r\n-if (!defined('NV_IS_MOD_LIBRABY')) {\r\n-    exit('Stop!!!');\r\n-}\r\n-\r\n-/**\r\n- * nv_theme_detail()\r\n- *\r\n- * @param array $array_data\r\n- * @return string\r\n- */\r\n-function nv_theme_detail($array_data)\r\n-{\r\n-    global $op;\r\n-    [$template, $dir] = get_module_tpl_dir('detail.tpl', true);\r\n-    $xtpl = new XTemplate('detail.tpl', $dir);\r\n-    $xtpl->assign('LANG', \\NukeViet\\Core\\Language::$lang_module);\r\n-    $xtpl->assign('GLANG', \\NukeViet\\Core\\Language::$lang_global);\r\n-    $xtpl->assign('TEMPLATE', $template);\r\n-\r\n-    $xtpl->assign('CTS', $array_data);\r\n-\r\n-    $xtpl->parse('main');\r\n-    return $xtpl->text('main');\r\n-}\r\n-\r\n-/**\r\n- * nv_theme_list()\r\n- *\r\n- * @param array $array_data\r\n- * @param mixed $generate_page\r\n- * @return string\r\n- */\r\n-function nv_theme_list($array_data, $generate_page)\r\n-{\r\n-    [$template, $dir] = get_module_tpl_dir('main.tpl', true);\r\n-    $xtpl = new XTemplate('main.tpl', $dir);\r\n-    $xtpl->assign('LANG', \\NukeViet\\Core\\Language::$lang_module);\r\n-    $xtpl->assign('GLANG', \\NukeViet\\Core\\Language::$lang_global);\r\n-    $xtpl->assign('TEMPLATE', $template);\r\n-\r\n-    if (!empty($array_data)) {\r\n-        foreach ($array_data as $value) {\r\n-            $xtpl->assign('LOOP', $value);\r\n-            $xtpl->parse('main.loop');\r\n-        }\r\n-\r\n-        if (!empty($generate_page)) {\r\n-            $xtpl->assign('GENERATE_PAGE', $generate_page);\r\n-            $xtpl->parse('main.gp');\r\n-        }\r\n-    }\r\n-\r\n-    $xtpl->parse('main');\r\n-    return $xtpl->text('main');\r\n-}\r\n+<?php\n+\n+/**\n+ * NukeViet Content Management System\n+ * @version 5.x\n+ */\n+\n+if (!defined('NV_IS_MOD_LIBRABY')) {\n+    exit('Stop!!!');\n+}\n+\n+function nv_theme_books_list($books, $categories, $current_catid, $generate_page, $page_title = '')\n+{\n+    [$template, $dir] = get_module_tpl_dir('books_list.tpl', true);\n+    $xtpl = new XTemplate('books_list.tpl', $dir);\n+    $xtpl->assign('LANG', \\NukeViet\\Core\\Language::$lang_module);\n+    $xtpl->assign('GLANG', \\NukeViet\\Core\\Language::$lang_global);\n+    $xtpl->assign('TEMPLATE', $template);\n+    $xtpl->assign('PAGE_TITLE', $page_title);\n+\n+    $xtpl->assign('URL_ALL', NV_BASE_SITEURL . 'index.php?' . NV_LANG_VARIABLE . '=' . NV_LANG_DATA . '&' . NV_NAME_VARIABLE . '=' . $GLOBALS['module_name']);\n+\n+    foreach ($categories as $id => $name) {\n+        $xtpl->assign('CAT', [\n+            'id' => $id,\n+            'name' => $name,\n+            'link' => NV_BASE_SITEURL . 'index.php?' . NV_LANG_VARIABLE . '=' . NV_LANG_DATA . '&' . NV_NAME_VARIABLE . '=' . $GLOBALS['module_name'] . '&' . NV_OP_VARIABLE . '=category&catid=' . (int) $id,\n+            'active' => ((int) $current_catid === (int) $id) ? 1 : 0\n+        ]);\n+        if ((int) $current_catid === (int) $id) {\n+            $xtpl->parse('main.cat_loop.active');\n+        }\n+        $xtpl->parse('main.cat_loop');\n+    }\n+\n+    if (defined('NV_IS_USER')) {\n+        $xtpl->assign('URL_BORROWED', NV_BASE_SITEURL . 'index.php?' . NV_LANG_VARIABLE . '=' . NV_LANG_DATA . '&' . NV_NAME_VARIABLE . '=' . $GLOBALS['module_name'] . '&' . NV_OP_VARIABLE . '=borrowed');\n+        $xtpl->parse('main.borrowed_link');\n+    }\n+\n+    if (!empty($books)) {\n+        foreach ($books as $row) {\n+            $xtpl->assign('ROW', $row);\n+            $xtpl->parse('main.loop');\n+        }\n+\n+        if (!empty($generate_page)) {\n+            $xtpl->assign('GENERATE_PAGE', $generate_page);\n+            $xtpl->parse('main.gp');\n+        }\n+    } else {\n+        $xtpl->parse('main.empty');\n+    }\n+\n+    $xtpl->parse('main');\n+    return $xtpl->text('main');\n+}\n+\n+function nv_theme_borrowed_list($rows, $generate_page)\n+{\n+    [$template, $dir] = get_module_tpl_dir('borrowed_list.tpl', true);\n+    $xtpl = new XTemplate('borrowed_list.tpl', $dir);\n+    $xtpl->assign('LANG', \\NukeViet\\Core\\Language::$lang_module);\n+    $xtpl->assign('GLANG', \\NukeViet\\Core\\Language::$lang_global);\n+    $xtpl->assign('TEMPLATE', $template);\n+\n+    $xtpl->assign('URL_HOME', NV_BASE_SITEURL . 'index.php?' . NV_LANG_VARIABLE . '=' . NV_LANG_DATA . '&' . NV_NAME_VARIABLE . '=' . $GLOBALS['module_name']);\n+\n+    if (!empty($rows)) {\n+        foreach ($rows as $row) {\n+            $xtpl->assign('ROW', $row);\n+            if (!empty($row['is_overdue'])) {\n+                $xtpl->parse('main.loop.overdue');\n+            }\n+            $xtpl->parse('main.loop');\n+        }\n+\n+        if (!empty($generate_page)) {\n+            $xtpl->assign('GENERATE_PAGE', $generate_page);\n+            $xtpl->parse('main.gp');\n+        }\n+    } else {\n+        $xtpl->parse('main.empty');\n+    }\n+\n+    $xtpl->parse('main');\n+    return $xtpl->text('main');\n+}\n"
                },
                {
                    "date": 1770122056681,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,9 +10,9 @@\n }\n \n function nv_theme_books_list($books, $categories, $current_catid, $generate_page, $page_title = '')\n {\n-    [$template, $dir] = get_module_tpl_dir('books_list.tpl', true);\n+    [$template, $dir] = get_module_tpl_dir('books_list.tpl');\n     $xtpl = new XTemplate('books_list.tpl', $dir);\n     $xtpl->assign('LANG', \\NukeViet\\Core\\Language::$lang_module);\n     $xtpl->assign('GLANG', \\NukeViet\\Core\\Language::$lang_global);\n     $xtpl->assign('TEMPLATE', $template);\n@@ -57,9 +57,9 @@\n }\n \n function nv_theme_borrowed_list($rows, $generate_page)\n {\n-    [$template, $dir] = get_module_tpl_dir('borrowed_list.tpl', true);\n+    [$template, $dir] = get_module_tpl_dir('borrowed_list.tpl');\n     $xtpl = new XTemplate('borrowed_list.tpl', $dir);\n     $xtpl->assign('LANG', \\NukeViet\\Core\\Language::$lang_module);\n     $xtpl->assign('GLANG', \\NukeViet\\Core\\Language::$lang_global);\n     $xtpl->assign('TEMPLATE', $template);\n"
                },
                {
                    "date": 1770122127471,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,9 +10,9 @@\n }\n \n function nv_theme_books_list($books, $categories, $current_catid, $generate_page, $page_title = '')\n {\n-    [$template, $dir] = get_module_tpl_dir('books_list.tpl');\n+    [$template, $dir] = get_module_tpl_dir('books_list.tpl', true);\n     $xtpl = new XTemplate('books_list.tpl', $dir);\n     $xtpl->assign('LANG', \\NukeViet\\Core\\Language::$lang_module);\n     $xtpl->assign('GLANG', \\NukeViet\\Core\\Language::$lang_global);\n     $xtpl->assign('TEMPLATE', $template);\n@@ -57,9 +57,9 @@\n }\n \n function nv_theme_borrowed_list($rows, $generate_page)\n {\n-    [$template, $dir] = get_module_tpl_dir('borrowed_list.tpl');\n+    [$template, $dir] = get_module_tpl_dir('borrowed_list.tpl', true);\n     $xtpl = new XTemplate('borrowed_list.tpl', $dir);\n     $xtpl->assign('LANG', \\NukeViet\\Core\\Language::$lang_module);\n     $xtpl->assign('GLANG', \\NukeViet\\Core\\Language::$lang_global);\n     $xtpl->assign('TEMPLATE', $template);\n"
                },
                {
                    "date": 1770123395699,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -55,34 +55,5 @@\n     $xtpl->parse('main');\n     return $xtpl->text('main');\n }\n \n-function nv_theme_borrowed_list($rows, $generate_page)\n-{\n-    [$template, $dir] = get_module_tpl_dir('borrowed_list.tpl', true);\n-    $xtpl = new XTemplate('borrowed_list.tpl', $dir);\n-    $xtpl->assign('LANG', \\NukeViet\\Core\\Language::$lang_module);\n-    $xtpl->assign('GLANG', \\NukeViet\\Core\\Language::$lang_global);\n-    $xtpl->assign('TEMPLATE', $template);\n \n-    $xtpl->assign('URL_HOME', NV_BASE_SITEURL . 'index.php?' . NV_LANG_VARIABLE . '=' . NV_LANG_DATA . '&' . NV_NAME_VARIABLE . '=' . $GLOBALS['module_name']);\n-\n-    if (!empty($rows)) {\n-        foreach ($rows as $row) {\n-            $xtpl->assign('ROW', $row);\n-            if (!empty($row['is_overdue'])) {\n-                $xtpl->parse('main.loop.overdue');\n-            }\n-            $xtpl->parse('main.loop');\n-        }\n-\n-        if (!empty($generate_page)) {\n-            $xtpl->assign('GENERATE_PAGE', $generate_page);\n-            $xtpl->parse('main.gp');\n-        }\n-    } else {\n-        $xtpl->parse('main.empty');\n-    }\n-\n-    $xtpl->parse('main');\n-    return $xtpl->text('main');\n-}\n"
                },
                {
                    "date": 1770173923849,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,9 +4,9 @@\n  * NukeViet Content Management System\n  * @version 5.x\n  */\n \n-if (!defined('NV_IS_MOD_LIBRABY')) {\n+if (!defined('NV_IS_MOD_LIBRABYMGT')) {\n     exit('Stop!!!');\n }\n \n function nv_theme_books_list($books, $categories, $current_catid, $generate_page, $page_title = '')\n"
                }
            ],
            "date": 1770046735813,
            "name": "Commit-0",
            "content": "<?php\r\n\r\n/**\r\n * NukeViet Content Management System\r\n * @version 5.x\r\n * @author VINADES.,JSC <contact@vinades.vn>\r\n * @copyright (C) 2009-2025 VINADES.,JSC. All rights reserved\r\n * @license GNU/GPL version 2 or any later version\r\n * @see https://github.com/nukeviet The NukeViet CMS GitHub project\r\n */\r\n\r\nif (!defined('NV_IS_MOD_LIBRABY')) {\r\n    exit('Stop!!!');\r\n}\r\n\r\n/**\r\n * nv_theme_detail()\r\n *\r\n * @param array $array_data\r\n * @return string\r\n */\r\nfunction nv_theme_detail($array_data)\r\n{\r\n    global $op;\r\n    [$template, $dir] = get_module_tpl_dir('detail.tpl', true);\r\n    $xtpl = new XTemplate('detail.tpl', $dir);\r\n    $xtpl->assign('LANG', \\NukeViet\\Core\\Language::$lang_module);\r\n    $xtpl->assign('GLANG', \\NukeViet\\Core\\Language::$lang_global);\r\n    $xtpl->assign('TEMPLATE', $template);\r\n\r\n    $xtpl->assign('CTS', $array_data);\r\n\r\n    $xtpl->parse('main');\r\n    return $xtpl->text('main');\r\n}\r\n\r\n/**\r\n * nv_theme_list()\r\n *\r\n * @param array $array_data\r\n * @param mixed $generate_page\r\n * @return string\r\n */\r\nfunction nv_theme_list($array_data, $generate_page)\r\n{\r\n    [$template, $dir] = get_module_tpl_dir('main.tpl', true);\r\n    $xtpl = new XTemplate('main.tpl', $dir);\r\n    $xtpl->assign('LANG', \\NukeViet\\Core\\Language::$lang_module);\r\n    $xtpl->assign('GLANG', \\NukeViet\\Core\\Language::$lang_global);\r\n    $xtpl->assign('TEMPLATE', $template);\r\n\r\n    if (!empty($array_data)) {\r\n        foreach ($array_data as $value) {\r\n            $xtpl->assign('LOOP', $value);\r\n            $xtpl->parse('main.loop');\r\n        }\r\n\r\n        if (!empty($generate_page)) {\r\n            $xtpl->assign('GENERATE_PAGE', $generate_page);\r\n            $xtpl->parse('main.gp');\r\n        }\r\n    }\r\n\r\n    $xtpl->parse('main');\r\n    return $xtpl->text('main');\r\n}\r\n"
        }
    ]
}